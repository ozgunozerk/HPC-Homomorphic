#include <iostream>
#include <cstdio>
#include <stdlib.h>


__global__ void GPU_NTT(int * f, const int N, const int q, const int*zetas)
{  // inside f, there are multiple f_array's. We will assign each f_array to a single block, same goes for zetas


    int local_idx = threadIdx.x;  // local index

    // INNER GPU MEMORY OPERATIONS START
    //**********************

    __shared__ int shared_f[1024];  // each block will handle a single f_array
    __shared__ int shared_zetas[1024];  // each block will handle a single zetas_array

    // necessary variables for filling the shared_f and shared_zetas, since f and zetas size is bigger than thread count in a single block
    int global_idx = blockIdx.x * N + local_idx;  



    shared_f[local_idx] = f[global_idx];  // filling of shared_f
    shared_zetas[local_idx] = zetas[local_idx];  // filling of shared_zetas (there is only 1 zetas, but many f's)
    
    __syncthreads();  // we have to wait for each thread to finish filling the arrays

    //**********************
    // INNER GPU MEMORY OPERATIONS END
    
    
    // here is the actual NTT function
    // thread amount inside a block should be equal to N for this to work
    for (int length = N / 2; length >= 1; length /= 2)  
    {
        int a = length * 2;
        if ((local_idx % a) < length)
        {
            int omega = shared_zetas[(N/a) + (local_idx/a)];
            int t = (((omega * shared_f[local_idx + length]) % q) + q) % q;
            shared_f[local_idx + length] = (((shared_f[local_idx] - t + q) % q) + q) % q;
            shared_f[local_idx] = (((shared_f[local_idx] + t) % q) + q) % q;
        }
        __syncthreads(); 
    }
    
    f[global_idx] = shared_f[local_idx];  

}




int main(void)
{
    const int N = 1024;
    const int q = 132120577;
    
    //const int N_inv = 131991553;


    int zetas_h[N] = {73993, 130039810, 123773922, 62317158, 100996264, 107436519, 100629264, 91990459, 24844551, 21156212, 30959406, 40589258, 50212326, 8634096, 5255250, 8778655, 88464825, 59334666, 65663373, 69007650, 58791514, 56997678, 118005609, 83835664, 118836050, 2513423, 94303974, 91168880, 34321720, 29488301, 74318843, 69115915, 100963424, 1365913, 54582189, 12138892, 29308593, 127041983, 64881974, 102440121, 131841038, 60746459, 98322802, 22047288, 55095103, 27634860, 120340351, 103344840, 73306167, 20835834, 72773506, 4746368, 30335314, 17476489, 115899670, 9033518, 36043146, 64037606, 38137563, 67492112, 89661561, 7072873, 35128224, 78148787, 24682248, 35687801, 85829890, 5425465, 121444147, 13043299, 55307844, 99236040, 75845351, 72435936, 105941710, 129859659, 106178235, 125594309, 25523595, 118380479, 83928973, 77075155, 106099083, 68104374, 7537072, 86036830, 5164967, 123325799, 101681132, 109246285, 72597206, 77246716, 15309687, 97192272, 100477606, 20893692, 116159722, 67297026, 62109962, 25503236, 51779732, 130517516, 119783437, 82037011, 81968999, 28324377, 30921336, 115163325, 6851917, 20804308, 50516624, 89323091, 79541126, 103960796, 127256468, 112811095, 50495324, 17146319, 102379743, 53119802, 22397905, 51340730, 124044531, 85939229, 21271611, 51933402, 3955243, 115871103, 42523895, 22074628, 4487154, 107088895, 110578755, 21143300, 55789572, 2207786, 77932000, 120578104, 97454486, 36435185, 44652372, 103354963, 66799601, 8885612, 4813529, 96525050, 76726166, 78294975, 80817419, 59201765, 99909486, 63439313, 101614890, 9531511, 47102971, 39374268, 10447348, 94301356, 96243099, 54161008, 8245268, 35965779, 12095567, 120535149, 64352376, 54749030, 8571407, 120101215, 65469439, 104232870, 18216032, 93476101, 119842129, 37073395, 19621195, 105045090, 20735151, 13443149, 84142013, 55009310, 70836982, 46622930, 19293451, 57526264, 78993614, 73127029, 102390975, 67286987, 73333120, 89168108, 106723922, 122331118, 36903141, 55916329, 67519248, 45776081, 40159287, 50081484, 3519403, 121719855, 76621850, 61477336, 111585600, 47282674, 564619, 107708488, 60982145, 24210201, 80389404, 33879713, 53047231, 19263280, 31775951, 71319463, 41713782, 84149933, 26711505, 66208025, 39354224, 41809022, 76288940, 61434095, 36526186, 11575165, 83061668, 101736847, 51058874, 103144921, 64133782, 6784017, 84226684, 123236371, 107520161, 126531385, 86201817, 74337522, 66378420, 32624198, 91541702, 94130273, 77118205, 48923460, 112576064, 71357409, 19133537, 121687416, 111541746, 1919985, 18975443, 98228784, 47294240, 328869, 113066275, 27340012, 68978368, 87890501, 58020392, 109921164, 21273387, 55867366, 80496470, 9772913, 73665829, 111083785, 130853960, 125705820, 122906326, 31879162, 49832130, 102029929, 98081244, 61287366, 34348201, 22977983, 84273109, 103770183, 59530747, 33123401, 26135894, 105551157, 13744944, 115411142, 87184667, 86902955, 129123487, 22613053, 98305347, 8676598, 1664107, 129272524, 109247925, 53116567, 117823780, 34285979, 51861674, 63852332, 27552655, 30329494, 5842177, 73059434, 81223848, 78964099, 105199543, 49037195, 110096333, 108897505, 26962753, 78783998, 82719498, 79991784, 107607792, 113234668, 69053559, 63702172, 6744657, 52218175, 81790402, 124005752, 1994080, 30861325, 9176282, 96778592, 95414806, 25974774, 106638942, 36458175, 32532095, 3667931, 76617609, 33931524, 101434819, 1369596, 10319629, 21180905, 41737231, 44737463, 25424556, 87363272, 91508565, 77565158, 88089156, 113659257, 27546627, 21738155, 69827360, 117588704, 71165647, 27443427, 53006865, 114937607, 47484093, 996848, 124574199, 120097207, 114027764, 94655460, 60573488, 16176548, 69764414, 29935902, 124429034, 14879163, 78389172, 120321580, 94098464, 35287301, 2131282, 58034288, 15596179, 102136332, 100916469, 66673995, 23658940, 45986105, 85723311, 73163352, 7238877, 122122803, 48523166, 85430462, 14321022, 29193860, 27024338, 91707993, 107983436, 110929252, 62533751, 124188548, 61564817, 90075906, 103985698, 28585801, 107312375, 50134726, 57443368, 50614796, 92755865, 113500646, 9687641, 44852820, 22033072, 18972199, 12048873, 39124775, 94766075, 8096242, 895629, 97591719, 70605426, 16962063, 77538275, 90867202, 60208268, 128461961, 17030393, 44446893, 1813257, 1989270, 45731169, 106760894, 115133302, 79033961, 9040074, 115252463, 6511186, 43608803, 119201504, 63931417, 126860080, 75118480, 54353702, 70512375, 20961247, 41722214, 17034424, 112592044, 126457685, 117258996, 69404510, 46871834, 94144778, 114665673, 19959914, 40885335, 22451960, 10091572, 5258384, 93683727, 130479471, 102895737, 12659378, 59815295, 85380247, 61935909, 33571704, 29775049, 469371, 115738204, 93665776, 88587319, 118643498, 68771343, 12598329, 120685381, 12457692, 106435905, 25963933, 1682151, 58908998, 23234900, 118512083, 23172258, 100556092, 10848102, 55448708, 37513138, 63764320, 93604385, 29688537, 29517126, 74105871, 81810181, 83054003, 64226085, 120353569, 80846650, 22230865, 13422323, 30486790, 70911119, 59788203, 76114384, 77007186, 106826437, 56140431, 44687435, 125730687, 50099812, 37035744, 7734604, 96078624, 96018903, 45466874, 25113108, 23404578, 39010297, 112030608, 122445731, 14204781, 118974797, 89151282, 57820094, 73993, 90400151, 69654060, 25334594, 12485878, 119473431, 73893740, 62146901, 129274342, 46998220, 72764132, 88131407,\
            130012478, 59675533, 20855139, 54262883, 128049914, 115288205, 27859791, 19107131, 90497677, 8249837, 4333961, 59075625, 15086569, 82056200, 17794504, 46517374, 77417443, 88647315, 83614782, 102724656, 92846721, 127879781, 38112941, 37353310, 3570971, 102635723, 78616310, 94370663, 59001362, 70711247, 111636458, 52216765, 71552944, 88146328, 77304628, 52111091, 65046673, 122972726, 23793246, 21513758, 4406149, 73763478, 81870394, 19098331, 86655233, 94327807, 81415493, 50273770, 25229595, 13486392, 34567111, 74023509, 10840393, 85607471, 39155534, 64118819, 99965470, 104128499, 90549094, 39120368, 71427891, 16765289, 98994043, 104665485, 28151627, 2560811, 35837197, 128889278, 93018458, 37237710, 116883656, 36018025, 9612979, 25280022, 78694547, 73953748, 85742811, 59223991, 58764469, 47975391, 7842993, 92655409, 82512391, 44080679, 34293788, 16418265, 20267898, 114860634, 105218030, 28985573, 91187050, 16765235, 4935245, 109034987, 30382739, 31172533, 47240632, 36319217, 53315725, 83728515, 43313076, 46944334, 118555088, 117538629, 62711749, 85801413, 118920927, 38464213, 99787354, 123804986, 10498093, 70120964, 129999499, 113352718, 13217244, 82041595, 19021480, 93376730, 131096498, 29122737, 90726259, 16444643, 62493208, 59676326, 19892835, 97325616, 72931092, 28270020, 23692357, 8418768, 72091223, 41097564, 102496282, 3873184, 110127725, 57024879, 13848470, 58467210, 59952717, 85227153, 72759854, 5453397, 81432520, 29368697, 125245114, 88321984, 16524007, 54123380, 91411115, 43223613, 2500433, 89850149, 131882865, 95965393, 45348551, 87071898, 79244222, 96188112, 96849799, 64935343, 74005165, 84296561, 90181559, 79920037, 71887819, 95220301, 2017938, 65259191, 85398959, 102194020, 17485358, 12222943, 92274799, 22146339, 25166264, 66326000, 77571347, 110561595, 108393833, 65683904, 38147154, 61062942, 76339163, 66449461, 114346261, 93422493, 1528912, 21738079, 54467403, 113177115, 74202916, 34018322, 27751335, 28827367, 69909281, 94619627, 52673055, 5776011, 85661867, 31092364, 112274628, 113059802, 59072229, 59560190, 72678122, 31519242, 131699929, 103774968, 128005672, 84539650, 23557586, 75603731, 129120015, 112524919, 11364567, 57009148, 76167417, 43697858, 57412122, 62936594, 98728818, 108442931, 78070029, 12403682, 88101662, 119340824, 19535027, 112952957, 51742512, 21886557, 34685433, 14145486, 75820686, 131770115, 207742, 35829830, 4582120, 25232588, 97097898, 23817749, 105829858, 71353469, 98493914, 42799399, 108956795, 53967732, 129290490, 5399262, 47572973, 31233688, 121281062, 69287758, 84817989, 62118460, 84223654, 86172685, 7732174, 130766717, 74313259, 61508067, 55017421, 82311283, 57402145, 79818364, 90646168, 63106843, 24319193, 3091700, 97560223, 3135611, 3652152, 33987302, 66768413, 32643501, 9173836, 33632171, 128012064, 128455263, 48451934, 63338012, 26559618, 75245170, 90805894, 125888733, 83098305, 102249197, 113795394, 41171430, 95378488, 22300636, 13870667, 113884061, 67431003, 15457966, 34270029, 40265620, 45965412, 94465066, 108901128, 14278292, 113037343, 113228321, 37986072, 45268987, 2065124, 47776240, 101397508, 82088434, 12988823, 3084456, 32587786, 125539540, 30135812, 11801589, 42512972, 25553325, 4904244, 7930601, 92944628, 4034269, 55494114, 24419291, 76566585, 110163601, 106396782, 7114217, 77919949, 92991591, 76494767, 118315420, 33430232, 35398517, 28564318, 72497314, 94122136, 60346098, 5513123, 108933838, 7989188, 36492098, 94531625, 54749108, 36294432, 129665010, 87764013, 71009121, 127341712, 45723281, 55104517, 125260295, 24552919, 9587795, 5359429, 46420219, 80100665, 80198907, 66953229, 76609276, 53640408, 26566855, 130422747, 16527207, 80290207, 67382538, 9406703, 109939618, 130062440, 79288778, 48353306, 101969607, 99029316, 36691329, 26485873, 129417688, 65110626, 97101814, 112250475, 31885316, 39829942, 30856200, 50006252, 69340489, 88166334, 50724786, 17105526, 8822473, 63490288, 57936597, 57296893, 28789982, 114726870, 65513928, 122924931, 30538188, 77867520, 53928032, 127550861, 60566636, 85646427, 52834633, 16638261, 3088585, 95926400, 13551065, 65939546, 9732332, 46290270, 69530912, 55730503, 38897099, 107834708, 20731717, 70561956, 97428885, 103526683, 32199173, 119385898, 61136827, 43108206, 112698222, 22095868, 22378320, 129951029, 28008380, 72102488, 118720015, 53201017, 22466912, 129256806, 70049080, 50106896, 63741086, 3741082, 92306369, 120628624, 101819029, 120574582, 116018216, 102586001, 5914012, 63106439, 89380815, 72125895, 34579182, 114577229, 25368586, 94776456, 75428643, 36608749, 106080021, 77486962, 107838057, 108859004, 68564849, 116104889, 9815409, 63533207, 67007776, 89741352, 56158465, 76621601, 51106011, 75973463, 120538418, 87525090, 44371811, 107205039, 107566308, 47526249, 12246324, 90445978, 35673292, 130500063, 62808621, 27210295, 7568430, 114441349, 21953766, 115224888, 27779533, 28589419, 30792762, 127970103, 107817953, 52414313, 128360427, 72918235, 92334785, 1618416, 74782081, 44155731, 50405316, 70537215, 50660202, 103656187, 90526685, 35170498, 108108911, 54640570, 85811505};
    //int zetas_inv[N] = {46309072, 77480007, 24011666, 96950079, 41593892, 28464390, 81460375, 61583362, 81715261, 87964846, 57338496, 130502161, 39785792, 59202342, 3760150, 79706264, 24302624, 4150474, 101327815, 103531158, 104341044, 16895689, 110166811, 17679228, 124552147, 104910282, 69311956, 1620514, 96447285, 41674599, 119874253, 84594328, 24554269, 24915538, 87748766, 44595487, 11582159, 56147114, 81014566, 55498976, 75962112, 42379225, 65112801, 68587370, 122305168, 16015688, 63555728, 23261573, 24282520, 54633615, 26040556, 95511828, 56691934, 37344121, 106751991, 17543348, 97541395, 59994682, 42739762, 69014138, 126206565, 29534576, 16102361, 11545995, 30301548, 11491953, 39814208, 128379495, 68379491, 82013681, 62071497, 2863771, 109653665, 78919560, 13400562, 60018089, 104112197, 2169548, 109742257, 110024709, 19422355, 89012371, 70983750, 12734679, 99921404, 28593894, 34691692, 61558621, 111388860, 24285869, 93223478, 76390074, 62589665, 85830307, 122388245, 66181031, 118569512, 36194177, 129031992, 115482316, 79285944, 46474150, 71553941, 4569716, 78192545, 54253057, 101582389, 9195646, 66606649, 17393707, 103330595, 74823684, 74183980, 68630289, 123298104, 115015051, 81395791, 43954243, 62780088, 82114325, 101264377, 92290635, 100235261, 19870102, 35018763, 67009951, 2702889, 105634704, 95429248, 33091261, 30150970, 83767271, 52831799, 2058137, 22180959, 122713874, 64738039, 51830370, 115593370, 1697830, 105553722, 78480169, 55511301, 65167348, 51921670, 52019912, 85700358, 126761148, 122532782, 107567658, 6860282, 77016060, 86397296, 4778865, 61111456, 44356564, 2455567, 95826145, 77371469, 37588952, 95628479, 124131389, 23186739, 126607454, 71774479, 37998441, 59623263, 103556259, 96722060, 98690345, 13805157, 55625810, 39128986, 54200628, 125006360, 25723795, 21956976, 55553992, 107701286, 76626463, 128086308, 39175949, 124189976, 127216333, 106567252, 89607605, 120318988, 101984765, 6581037, 99532791, 129036121, 119131754, 50032143, 30723069, 84344337, 130055453, 86851590, 94134505, 18892256, 19083234, 117842285, 23219449, 37655511, 86155165, 91854957, 97850548, 116662611, 64689574, 18236516, 118249910, 109819941, 36742089, 90949147, 18325183, 29871380, 49022272, 6231844, 41314683, 56875407, 105560959, 68782565, 83668643, 3665314, 4108513, 98488406, 122946741, 99477076, 65352164, 98133275, 128468425, 128984966, 34560354, 129028877, 107801384, 69013734, 41474409, 52302213, 74718432, 49809294, 77103156, 70612510, 57807318, 1353860, 124388403, 45947892, 47896923, 70002117, 47302588, 62832819, 10839515, 100886889, 84547604, 126721315, 2830087, 78152845, 23163782, 89321178, 33626663, 60767108, 26290719, 108302828, 35022679, 106887989, 127538457, 96290747, 131912835, 350462, 56299891, 117975091, 97435144, 110234020, 80378065, 19167620, 112585550, 12779753, 44018915, 119716895, 54050548, 23677646, 33391759, 69183983, 74708455, 88422719, 55953160, 75111429, 120756010, 19595658, 3000562, 56516846, 108562991, 47580927, 4114905, 28345609, 420648, 100601335, 59442455, 72560387, 73048348, 19060775, 19845949, 101028213, 46458710, 126344566, 79447522, 37500950, 62211296, 103293210, 104369242, 98102255, 57917661, 18943462, 77653174, 110382498, 130591665, 38698084, 17774316, 65671116, 55781414, 71057635, 93973423, 66436673, 23726744, 21558982, 54549230, 65794577, 106954313, 109974238, 39845778, 119897634, 114635219, 29926557, 46721618, 66861386, 130102639, 36900276, 60232758, 52200540, 41939018, 47824016, 58115412, 67185234, 35270778, 35932465, 52876355, 45048679, 86772026, 36155184, 237712, 42270428, 129620144, 88896964, 40709462, 77997197, 115596570, 43798593, 6875463, 102751880, 50688057, 126667180, 59360723, 46893424, 72167860, 73653367, 118272107, 75095698, 21992852, 128247393, 29624295, 91023013, 60029354, 123701809, 108428220, 103850557, 59189485, 34794961, 112227742, 72444251, 69627369, 115675934, 41394318, 102997840, 1024079, 38743847, 113099097, 50078982, 118903333, 18767859, 2121078, 61999613, 121622484, 8315591, 32333223, 93656364, 13199650, 46319164, 69408828, 14581948, 13565489, 85176243, 88807501, 48392062, 78804852, 95801360, 84879945, 100948044, 101737838, 23085590, 127185332, 115355342, 40933527, 103135004, 26902547, 17259943, 111852679, 115702312, 97826789, 88039898, 49608186, 39465168, 124277584, 84145186, 73356108, 72896586, 46377766, 58166829, 53426030, 106840555, 122507598, 96102552, 15236921, 94882867, 39102119, 3231299, 96283380, 129559766, 103968950, 27455092, 33126534, 115355288, 60692686, 93000209, 41571483, 27992078, 32155107, 68001758, 92965043, 46513106, 121280184, 58097068, 97553466, 118634185, 106890982, 81846807, 50705084, 37792770, 45465344, 113022246, 50250183, 58357099, 127714428, 110606819, 108327331, 9147851, 67073904, 80009486, 54815949, 43974249, 60567633, 79903812, 20484119, 61409330, 73119215, 37749914, 53504267, 29484854, 128549606, 94767267, 94007636, 4240796, 39273856, 29395921, 48505795, 43473262, 54703134, 85603203, 114326073, 50064377, 117034008, 73044952, 127786616, 123870740, 41622900, 113013446, 104260786, 16832372, 4070663, 77857694, 111265438, 72445044, 2108099, 43989170, 59356445, 85122357, 2846235, 69973676, 58226837, 12647146, 119634699, 106785983, 62466517, 41720426, 132046584, 74300483, 42969295, 13145780, 117915796, 9674846, 20089969, 93110280, 108715999, 107007469,\
            86653703, 36101674, 36041953, 124385973, 95084833, 82020765, 6389890, 87433142, 75980146, 25294140, 55113391, 56006193, 72332374, 61209458, 101633787, 118698254, 109889712, 51273927, 11767008, 67894492, 49066574, 50310396, 58014706, 102603451, 102432040, 38516192, 68356257, 94607439, 76671869, 121272475, 31564485, 108948319, 13608494, 108885677, 73211579, 130438426, 106156644, 25684672, 119662885, 11435196, 119522248, 63349234, 13477079, 43533258, 38454801, 16382373, 131651206, 102345528, 98548873, 70184668, 46740330, 72305282, 119461199, 29224840, 1641106, 38436850, 126862193, 122029005, 109668617, 91235242, 112160663, 17454904, 37975799, 85248743, 62716067, 14861581, 5662892, 19528533, 115086153, 90398363, 111159330, 61608202, 77766875, 57002097, 5260497, 68189160, 12919073, 88511774, 125609391, 16868114, 123080503, 53086616, 16987275, 25359683, 86389408, 130131307, 130307320, 87673684, 115090184, 3658616, 71912309, 41253375, 54582302, 115158514, 61515151, 34528858, 131224948, 124024335, 37354502, 92995802, 120071704, 113148378, 110087505, 87267757, 122432936, 18619931, 39364712, 81505781, 74677209, 81985851, 24808202, 103534776, 28134879, 42044671, 70555760, 7932029, 69586826, 21191325, 24137141, 40412584, 105096239, 102926717, 117799555, 46690115, 83597411, 9997774, 124881700, 58957225, 46397266, 86134472, 108461637, 65446582, 31204108, 29984245, 116524398, 74086289, 129989295, 96833276, 38022113, 11798997, 53731405, 117241414, 7691543, 102184675, 62356163, 115944029, 71547089, 37465117, 18092813, 12023370, 7546378, 131123729, 84636484, 17182970, 79113712, 104677150, 60954930, 14531873, 62293217, 110382422, 104573950, 18461320, 44031421, 54555419, 40612012, 44757305, 106696021, 87383114, 90383346, 110939672, 121800948, 130750981, 30685758, 98189053, 55502968, 128452646, 99588482, 95662402, 25481635, 106145803, 36705771, 35341985, 122944295, 101259252, 130126497, 8114825, 50330175, 79902402, 125375920, 68418405, 63067018, 18885909, 24512785, 52128793, 49401079, 53336579, 105157824, 23223072, 22024244, 83083382, 26921034, 53156478, 50896729, 59061143, 126278400, 101791083, 104567922, 68268245, 80258903, 97834598, 14296797, 79004010, 22872652, 2848053, 130456470, 123443979, 33815230, 109507524, 2997090, 45217622, 44935910, 16709435, 118375633, 26569420, 105984683, 98997176, 72589830, 28350394, 47847468, 109142594, 97772376, 70833211, 34039333, 30090648, 82288447, 100241415, 9214251, 6414757, 1266617, 21036792, 58454748, 122347664, 51624107, 76253211, 110847190, 22199413, 74100185, 44230076, 63142209, 104780565, 19054302, 131791708, 84826337, 33891793, 113145134, 130200592, 20578831, 10433161, 112987040, 60763168, 19544513, 83197117, 55002372, 37990304, 40578875, 99496379, 65742157, 57783055, 45918760, 5589192, 24600416, 8884206, 47893893, 125336560, 67986795, 28975656, 81061703, 30383730, 49058909, 120545412, 95594391, 70686482, 55831637, 90311555, 92766353, 65912552, 105409072, 47970644, 90406795, 60801114, 100344626, 112857297, 79073346, 98240864, 51731173, 107910376, 71138432, 24412089, 131555958, 84837903, 20534977, 70643241, 55498727, 10400722, 128601174, 82039093, 91961290, 86344496, 64601329, 76204248, 95217436, 9789459, 25396655, 42952469, 58787457, 64833590, 29729602, 58993548, 53126963, 74594313, 112827126, 85497647, 61283595, 77111267, 47978564, 118677428, 111385426, 27075487, 112499382, 95047182, 12278448, 38644476, 113904545, 27887707, 66651138, 12019362, 123549170, 77371547, 67768201, 11585428, 120025010, 96154798, 123875309, 77959569, 35877478, 37819221, 121673229, 92746309, 85017606, 122589066, 30505687, 68681264, 32211091, 72918812, 51303158, 53825602, 55394411, 35595527, 127307048, 123234965, 65320976, 28765614, 87468205, 95685392, 34666091, 11542473, 54188577, 129912791, 76331005, 110977277, 21541822, 25031682, 127633423, 110045949, 89596682, 16249474, 128165334, 80187175, 110848966, 46181348, 8076046, 80779847, 109722672, 79000775, 29740834, 114974258, 81625253, 19309482, 4864109, 28159781, 52579451, 42797486, 81603953, 111316269, 125268660, 16957252, 101199241, 103796200, 50151578, 50083566, 12337140, 1603061, 80340845, 106617341, 70010615, 64823551, 15960855, 111226885, 31642971, 34928305, 116810890, 54873861, 59523371, 22874292, 30439445, 8794778, 126955610, 46083747, 124583505, 64016203, 26021494, 55045422, 48191604, 13740098, 106596982, 6526268, 25942342, 2260918, 26178867, 59684641, 56275226, 32884537, 76812733, 119077278, 10676430, 126695112, 46290687, 96432776, 107438329, 53971790, 96992353, 125047704, 42459016, 64628465, 93983014, 68082971, 96077431, 123087059, 16220907, 114644088, 101785263, 127374209, 59347071, 111284743, 58814410, 28775737, 11780226, 104485717, 77025474, 110073289, 33797775, 71374118, 279539, 29680456, 67238603, 5078594, 102811984, 119981685, 77538388, 130754664, 31157153, 63004662, 57801734, 102632276, 97798857, 40951697, 37816603, 129607154, 13284527, 48284913, 14114968, 75122899, 73329063, 63112927, 66457204, 72785911, 43655752, 123341922, 126865327, 123486481, 81908251, 91531319, 101161171, 110964365, 107276026, 40130118, 31491313, 24684058, 31124313, 69803419, 8346655, 2080767, 132046584};
    
    
    
    int * f_d, * zetas_d;

    int blockNum = 1024;  // amount of f_array's

    int * f_returned = new int[N * blockNum];

    int * f_generated = new int[N * blockNum]; 
    for(int num = 0; num < blockNum; num++)
    {
        for(int i = 0; i < N; i++)
        {
            f_generated[N*num + i] = i; 
        }
    }


    // copying arrays and other variables to GPU MEM
    cudaMalloc((void**)&f_d, N * blockNum * sizeof(int));
    cudaMemcpy(f_d, f_generated, sizeof(int) * N * blockNum, cudaMemcpyHostToDevice);

    cudaMalloc((void**)&zetas_d, N * sizeof(int));
    cudaMemcpy(zetas_d, zetas_h, sizeof(int) * N, cudaMemcpyHostToDevice);

    // running the kernel
    float time;
    cudaEvent_t start, stop;

    cudaEventCreate(&start);
    cudaEventCreate(&stop);

    cudaEventRecord(start, 0);
    GPU_NTT<<<blockNum, N>>>(f_d, N, q, zetas_d);
    cudaEventRecord(stop, 0);
    cudaEventSynchronize(stop);
    cudaEventElapsedTime(&time, start, stop);
    printf("Kernel Duration: %f ms \n", time);

    // copying the result back to the host
    cudaMemcpy(f_returned, f_d, N * blockNum * sizeof(int), cudaMemcpyDeviceToHost); 
    cudaDeviceSynchronize();

    cudaFree(zetas_d);
    cudaFree(f_d);

    /*  FOR DEBUGGING
    for(int x = 0; x < N * blockNum; x++)
    {
        std::cout << f_returned[x] << " ";
    }
    */
    
  
    delete[] f_returned;

    return 0;
}



